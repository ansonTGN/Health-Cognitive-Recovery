<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LaMuralla Health - Cognitive Recovery Engine">
    <meta name="author" content="Ángel A. Urbina">
    
    <title>{% block title %}LaMuralla Health - Cognitive Engine{% endblock %}</title>
    
    <!-- ============================================
         FUENTES Y ESTILOS EXTERNOS (CDNs)
         ============================================ -->
    
    <!-- Google Fonts: Manrope (UI) & JetBrains Mono (Citas/Código) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- FontAwesome 6.4 (Iconos) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <!-- Vis.js Network (Visualización de Grafos) -->
    <link href="https://unpkg.com/vis-network/styles/vis-network.min.css" rel="stylesheet" />
    
    <!-- Animate.css (Animaciones de entrada) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <!-- ============================================
         LIBRERÍAS JS DE UTILIDAD (Carga temprana)
         ============================================ -->
    
    <!-- Marked.js (Markdown parser para el chat) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- DOMPurify (Seguridad para limpiar HTML del chat) -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    
    <!-- ============================================
         ESTILOS CRÍTICOS (Variables y Loader)
         Nota: El resto de estilos están en components/styles.html
         ============================================ -->
    <style>
        :root {
            /* Definición de colores base para que estén disponibles globalmente */
            --primary: #00695c; 
            --primary-dark: #004d40; 
            --bg-body: #eceff1;
            --font-main: 'Manrope', sans-serif;
        }

        body { 
            font-family: var(--font-main); 
            background-color: var(--bg-body); 
            height: 100vh; 
            overflow: hidden; /* Evita scroll en el body principal, lo manejamos en los paneles */
            margin: 0;
        }

        /* Pantalla de Carga (Overlay) */
        #loading { 
            display: none; /* Se activa por JS con display: flex */
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(255,255,255,0.98); 
            z-index: 9999; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            backdrop-filter: blur(5px);
            transition: opacity 0.3s ease;
        }

        .spinner-custom {
            width: 3rem; 
            height: 3rem; 
            border-width: 0.25em;
            color: var(--primary);
        }
    </style>
</head>
<body class="d-flex flex-column">

    <!-- OVERLAY DE CARGA GLOBAL -->
    <div id="loading">
        <div class="spinner-border spinner-custom mb-3" role="status"></div>
        <div class="fw-bold text-uppercase tracking-wide text-muted small" id="loader-text" style="letter-spacing: 2px;">
            Cargando Motor Cognitivo...
        </div>
    </div>

    <!-- BLOQUE DE CONTENIDO PRINCIPAL -->
    <!-- Aquí se inyectarán dashboard.html o login.html -->
    {% block content %}{% endblock %}

    <!-- ============================================
         SCRIPTS DEL SISTEMA
         ============================================ -->
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Vis.js Standalone -->
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

    <!-- BLOQUE DE SCRIPTS ESPECÍFICOS DE PÁGINA -->
    {% block scripts %}{% endblock %}
    
</body>
</html>
